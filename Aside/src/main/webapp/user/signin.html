<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>:: Say in an aside ::</title>
<link rel="stylesheet" href="../css/bootstrap.min.css">
<link rel="stylesheet" href="../css/common.css">
<script type="text/javascript" src="../js/jquery-latest.js"></script>
<script type="text/javascript" src="../js/common.js"></script>
<script>
	window.onload = function(){
		var inputs = document.getElementsByTagName("input");
		var div = document.getElementById("hasErrorGroup");
		var myform = document.getElementById("account");
	
		myform.onsubmit = function(){
			if(inputs[1].value == inputs[2].value && inputs[1].length!=0){
				return true;
			}else {
				div.className = "form-group has-error";
				return false;
			}
		}
	}
	
	var xmlReq;
	  
	  function createAjax() {
	    xmlReq = new XMLHttpRequest();
	  }
	  
	  $(function() {
	    $('#user_email').keyup(function() {
	      var emailMark = $('#user_email').val().indexOf("@");
	      var dotMark = $('#user_email').val().indexOf('.');
	      var emailLength = $('#user_email').val().length;
	      if(1 <= emailMark
	          && dotMark < emailLength-1
	          && emailMark < dotMark-1) {
	        createAjax();
	        var email = $('#user_email').val();
	        xmlReq.onreadystatechange = callBack;
	        xmlReq.open("POST", "check_email.jsp?email="+email, true);
	        xmlReq.send(null);
	      } else {
	        $('#result').html("이메일 형식을 맞춰주세요");
	      }
	    });
	  });
	  
	  function callBack() {
	    if(xmlReq.readyState == 4) {
	      if(xmlReq.status == 200) {
	        var result = (((xmlReq.responseXML).documentElement).firstChild).nodeValue;
	        if(result == "true") {
	          $('#result').html("사용가능한 아이디입니다");
	        } else {
	          $('#result').html("이미 사용중인 아이디입니다");
	        }
	      }
	    }
	  }
</script>
</head>

<body>
	<header id="logo_area">
		<a href="../"><img src="../image/logo.png" id="logo"></a>
	</header>
	
	<form action="signin.do" method="post" id="account">
		<div class="form-group">
			<input type="email" name="user_email" id="user_email" class="form-control input-lg" placeholder="email">
		</div>
		<div class="form-group">
			<input type="password" name="user_password" class="form-control input-lg" placeholder="password">
		</div>
		<div class="form-group" id="hasErrorGroup">
			<input type="password" name="user_password_retype" id="inputError"
					class="form-control input-lg" placeholder="retype password">
		</div>
		<div class="form-group">
			<input type="submit" value="SIGNIN"	class="btn btn-primary input-lg btn-block">
		</div>
	</form>
	<div id="result"></div>
</body>
</html>